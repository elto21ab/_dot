var qi=Object.create;var tr=Object.defineProperty;var Fi=Object.getOwnPropertyDescriptor;var Li=Object.getOwnPropertyNames;var Ii=Object.getPrototypeOf,zi=Object.prototype.hasOwnProperty;var mt=(a,n)=>()=>(a&&(n=a(a=0)),n);var Yr=(a,n)=>()=>(n||a((n={exports:{}}).exports,n),n.exports),Eo=(a,n)=>{for(var o in n)tr(a,o,{get:n[o],enumerable:!0})},Po=(a,n,o,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let l of Li(n))!zi.call(a,l)&&l!==o&&tr(a,l,{get:()=>n[l],enumerable:!(s=Fi(n,l))||s.enumerable});return a};var Ee=(a,n,o)=>(o=a!=null?qi(Ii(a)):{},Po(n||!a||!a.__esModule?tr(o,"default",{value:a,enumerable:!0}):o,a)),Mi=a=>Po(tr({},"__esModule",{value:!0}),a);var Bo=Yr((rr,vo)=>{(function(a,n){typeof rr=="object"&&typeof vo<"u"?n(rr):typeof define=="function"&&define.amd?define(["exports"],n):(a=typeof globalThis<"u"?globalThis:a||self,n(a.WebStreamsPolyfill={}))})(rr,function(a){"use strict";let n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function o(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let l=s();function f(e){return typeof e=="object"&&e!==null||typeof e=="function"}let m=o,_=Promise,y=Promise.prototype.then,b=Promise.resolve.bind(_),E=Promise.reject.bind(_);function R(e){return new _(e)}function S(e){return b(e)}function p(e){return E(e)}function h(e,t,r){return y.call(e,t,r)}function q(e,t,r){h(h(e,t,r),void 0,m)}function v(e,t){q(e,t)}function T(e,t){q(e,void 0,t)}function I(e,t,r){return h(e,t,r)}function O(e){h(e,void 0,m)}let P=(()=>{let e=l&&l.queueMicrotask;if(typeof e=="function")return e;let t=S(void 0);return r=>h(t,r)})();function L(e,t,r){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function k(e,t,r){try{return S(L(e,t,r))}catch(i){return p(i)}}let ae=16384;class Q{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){let r=this._back,i=r;r._elements.length===ae-1&&(i={_elements:[],_next:void 0}),r._elements.push(t),i!==r&&(this._back=i,r._next=i),++this._size}shift(){let t=this._front,r=t,i=this._cursor,u=i+1,d=t._elements,c=d[i];return u===ae&&(r=t._next,u=0),--this._size,this._cursor=u,t!==r&&(this._front=r),d[i]=void 0,c}forEach(t){let r=this._cursor,i=this._front,u=i._elements;for(;(r!==u.length||i._next!==void 0)&&!(r===u.length&&(i=i._next,u=i._elements,r=0,u.length===0));)t(u[r]),++r}peek(){let t=this._front,r=this._cursor;return t._elements[r]}}function un(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?pr(e):t._state==="closed"?ua(e):fn(e,t._storedError)}function br(e,t){let r=e._ownerReadableStream;return re(r,t)}function ue(e){e._ownerReadableStream._state==="readable"?yr(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):fa(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function ze(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function pr(e){e._closedPromise=R((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function fn(e,t){pr(e),yr(e,t)}function ua(e){pr(e),dn(e)}function yr(e,t){e._closedPromise_reject!==void 0&&(O(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function fa(e,t){fn(e,t)}function dn(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let cn=n("[[AbortSteps]]"),hn=n("[[ErrorSteps]]"),gr=n("[[CancelSteps]]"),_r=n("[[PullSteps]]"),mn=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},da=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function ca(e){return typeof e=="object"||typeof e=="function"}function fe(e,t){if(e!==void 0&&!ca(e))throw new TypeError(`${t} is not an object.`)}function ee(e,t){if(typeof e!="function")throw new TypeError(`${t} is not a function.`)}function ha(e){return typeof e=="object"&&e!==null||typeof e=="function"}function bn(e,t){if(!ha(e))throw new TypeError(`${t} is not an object.`)}function de(e,t,r){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function Sr(e,t,r){if(e===void 0)throw new TypeError(`${t} is required in '${r}'.`)}function wr(e){return Number(e)}function pn(e){return e===0?0:e}function ma(e){return pn(da(e))}function yn(e,t){let i=Number.MAX_SAFE_INTEGER,u=Number(e);if(u=pn(u),!mn(u))throw new TypeError(`${t} is not a finite number`);if(u=ma(u),u<0||u>i)throw new TypeError(`${t} is outside the accepted range of 0 to ${i}, inclusive`);return!mn(u)||u===0?0:u}function Rr(e,t){if(!Re(e))throw new TypeError(`${t} is not a ReadableStream.`)}function Me(e){return new Xe(e)}function gn(e,t){e._reader._readRequests.push(t)}function Tr(e,t,r){let u=e._reader._readRequests.shift();r?u._closeSteps():u._chunkSteps(t)}function Tt(e){return e._reader._readRequests.length}function _n(e){let t=e._reader;return!(t===void 0||!ge(t))}class Xe{constructor(t){if(de(t,1,"ReadableStreamDefaultReader"),Rr(t,"First parameter"),Te(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");un(this,t),this._readRequests=new Q}get closed(){return ge(this)?this._closedPromise:p(Ct("closed"))}cancel(t=void 0){return ge(this)?this._ownerReadableStream===void 0?p(ze("cancel")):br(this,t):p(Ct("cancel"))}read(){if(!ge(this))return p(Ct("read"));if(this._ownerReadableStream===void 0)return p(ze("read from"));let t,r,i=R((d,c)=>{t=d,r=c});return et(this,{_chunkSteps:d=>t({value:d,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:d=>r(d)}),i}releaseLock(){if(!ge(this))throw Ct("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ue(this)}}}Object.defineProperties(Xe.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Xe.prototype,n.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function ge(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof Xe}function et(e,t){let r=e._ownerReadableStream;r._disturbed=!0,r._state==="closed"?t._closeSteps():r._state==="errored"?t._errorSteps(r._storedError):r._readableStreamController[_r](t)}function Ct(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let Sn=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class wn{constructor(t,r){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=r}next(){let t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?I(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){let r=()=>this._returnSteps(t);return this._ongoingPromise?I(this._ongoingPromise,r,r):r()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let t=this._reader;if(t._ownerReadableStream===void 0)return p(ze("iterate"));let r,i,u=R((c,g)=>{r=c,i=g});return et(t,{_chunkSteps:c=>{this._ongoingPromise=void 0,P(()=>r({value:c,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ue(t),r({value:void 0,done:!0})},_errorSteps:c=>{this._ongoingPromise=void 0,this._isFinished=!0,ue(t),i(c)}}),u}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;let r=this._reader;if(r._ownerReadableStream===void 0)return p(ze("finish iterating"));if(!this._preventCancel){let i=br(r,t);return ue(r),I(i,()=>({value:t,done:!0}))}return ue(r),S({value:t,done:!0})}}let Rn={next(){return Tn(this)?this._asyncIteratorImpl.next():p(Cn("next"))},return(e){return Tn(this)?this._asyncIteratorImpl.return(e):p(Cn("return"))}};Sn!==void 0&&Object.setPrototypeOf(Rn,Sn);function ba(e,t){let r=Me(e),i=new wn(r,t),u=Object.create(Rn);return u._asyncIteratorImpl=i,u}function Tn(e){if(!f(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof wn}catch{return!1}}function Cn(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let En=Number.isNaN||function(e){return e!==e};function tt(e){return e.slice()}function Pn(e,t,r,i,u){new Uint8Array(e).set(new Uint8Array(r,i,u),t)}function cs(e){return e}function Et(e){return!1}function An(e,t,r){if(e.slice)return e.slice(t,r);let i=r-t,u=new ArrayBuffer(i);return Pn(u,0,e,t,i),u}function pa(e){return!(typeof e!="number"||En(e)||e<0)}function vn(e){let t=An(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function Cr(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function Er(e,t,r){if(!pa(r)||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function ya(e){return e._queue.peek().value}function _e(e){e._queue=new Q,e._queueTotalSize=0}class rt{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Pr(this))throw kr("view");return this._view}respond(t){if(!Pr(this))throw kr("respond");if(de(t,1,"respond"),t=yn(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Et(this._view.buffer),kt(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!Pr(this))throw kr("respondWithNewView");if(de(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Et(t.buffer),Ot(this._associatedReadableByteStreamController,t)}}Object.defineProperties(rt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(rt.prototype,n.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class $e{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Ae(this))throw ot("byobRequest");return Br(this)}get desiredSize(){if(!Ae(this))throw ot("desiredSize");return Ln(this)}close(){if(!Ae(this))throw ot("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);nt(this)}enqueue(t){if(!Ae(this))throw ot("enqueue");if(de(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`);Bt(this,t)}error(t=void 0){if(!Ae(this))throw ot("error");te(this,t)}[gr](t){Bn(this),_e(this);let r=this._cancelAlgorithm(t);return vt(this),r}[_r](t){let r=this._controlledReadableByteStream;if(this._queueTotalSize>0){let u=this._queue.shift();this._queueTotalSize-=u.byteLength,Wn(this);let d=new Uint8Array(u.buffer,u.byteOffset,u.byteLength);t._chunkSteps(d);return}let i=this._autoAllocateChunkSize;if(i!==void 0){let u;try{u=new ArrayBuffer(i)}catch(c){t._errorSteps(c);return}let d={buffer:u,bufferByteLength:i,byteOffset:0,byteLength:i,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(d)}gn(r,t),ve(this)}}Object.defineProperties($e.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty($e.prototype,n.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Ae(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof $e}function Pr(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof rt}function ve(e){if(!wa(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let r=e._pullAlgorithm();q(r,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ve(e))},i=>{te(e,i)})}function Bn(e){vr(e),e._pendingPullIntos=new Q}function Ar(e,t){let r=!1;e._state==="closed"&&(r=!0);let i=kn(t);t.readerType==="default"?Tr(e,i,r):Ca(e,i,r)}function kn(e){let t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function Pt(e,t,r,i){e._queue.push({buffer:t,byteOffset:r,byteLength:i}),e._queueTotalSize+=i}function On(e,t){let r=t.elementSize,i=t.bytesFilled-t.bytesFilled%r,u=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),d=t.bytesFilled+u,c=d-d%r,g=u,C=!1;c>i&&(g=c-t.bytesFilled,C=!0);let B=e._queue;for(;g>0;){let D=B.peek(),W=Math.min(g,D.byteLength),$=t.byteOffset+t.bytesFilled;Pn(t.buffer,$,D.buffer,D.byteOffset,W),D.byteLength===W?B.shift():(D.byteOffset+=W,D.byteLength-=W),e._queueTotalSize-=W,Dn(e,W,t),g-=W}return C}function Dn(e,t,r){r.bytesFilled+=t}function Wn(e){e._queueTotalSize===0&&e._closeRequested?(vt(e),ct(e._controlledReadableByteStream)):ve(e)}function vr(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function qn(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let t=e._pendingPullIntos.peek();On(e,t)&&(At(e),Ar(e._controlledReadableByteStream,t))}}function ga(e,t,r){let i=e._controlledReadableByteStream,u=1;t.constructor!==DataView&&(u=t.constructor.BYTES_PER_ELEMENT);let d=t.constructor,c=t.buffer,g={buffer:c,bufferByteLength:c.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:u,viewConstructor:d,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(g),Mn(i,r);return}if(i._state==="closed"){let C=new d(g.buffer,g.byteOffset,0);r._closeSteps(C);return}if(e._queueTotalSize>0){if(On(e,g)){let C=kn(g);Wn(e),r._chunkSteps(C);return}if(e._closeRequested){let C=new TypeError("Insufficient bytes to fill elements in the given buffer");te(e,C),r._errorSteps(C);return}}e._pendingPullIntos.push(g),Mn(i,r),ve(e)}function _a(e,t){let r=e._controlledReadableByteStream;if(Or(r))for(;$n(r)>0;){let i=At(e);Ar(r,i)}}function Sa(e,t,r){if(Dn(e,t,r),r.bytesFilled<r.elementSize)return;At(e);let i=r.bytesFilled%r.elementSize;if(i>0){let u=r.byteOffset+r.bytesFilled,d=An(r.buffer,u-i,u);Pt(e,d,0,d.byteLength)}r.bytesFilled-=i,Ar(e._controlledReadableByteStream,r),qn(e)}function Fn(e,t){let r=e._pendingPullIntos.peek();vr(e),e._controlledReadableByteStream._state==="closed"?_a(e):Sa(e,t,r),ve(e)}function At(e){return e._pendingPullIntos.shift()}function wa(e){let t=e._controlledReadableByteStream;return t._state!=="readable"||e._closeRequested||!e._started?!1:!!(_n(t)&&Tt(t)>0||Or(t)&&$n(t)>0||Ln(e)>0)}function vt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function nt(e){let t=e._controlledReadableByteStream;if(!(e._closeRequested||t._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let i=new TypeError("Insufficient bytes to fill elements in the given buffer");throw te(e,i),i}vt(e),ct(t)}}function Bt(e,t){let r=e._controlledReadableByteStream;if(e._closeRequested||r._state!=="readable")return;let i=t.buffer,u=t.byteOffset,d=t.byteLength,c=i;if(e._pendingPullIntos.length>0){let g=e._pendingPullIntos.peek();Et(g.buffer),g.buffer=g.buffer}if(vr(e),_n(r))if(Tt(r)===0)Pt(e,c,u,d);else{e._pendingPullIntos.length>0&&At(e);let g=new Uint8Array(c,u,d);Tr(r,g,!1)}else Or(r)?(Pt(e,c,u,d),qn(e)):Pt(e,c,u,d);ve(e)}function te(e,t){let r=e._controlledReadableByteStream;r._state==="readable"&&(Bn(e),_e(e),vt(e),fo(r,t))}function Br(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),i=Object.create(rt.prototype);Ta(i,e,r),e._byobRequest=i}return e._byobRequest}function Ln(e){let t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function kt(e,t){let r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(t===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=r.buffer,Fn(e,t)}function Ot(e,t){let r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(t.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let u=t.byteLength;r.buffer=t.buffer,Fn(e,u)}function In(e,t,r,i,u,d,c){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,_e(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=d,t._pullAlgorithm=i,t._cancelAlgorithm=u,t._autoAllocateChunkSize=c,t._pendingPullIntos=new Q,e._readableStreamController=t;let g=r();q(S(g),()=>{t._started=!0,ve(t)},C=>{te(t,C)})}function Ra(e,t,r){let i=Object.create($e.prototype),u=()=>{},d=()=>S(void 0),c=()=>S(void 0);t.start!==void 0&&(u=()=>t.start(i)),t.pull!==void 0&&(d=()=>t.pull(i)),t.cancel!==void 0&&(c=C=>t.cancel(C));let g=t.autoAllocateChunkSize;if(g===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");In(e,i,u,d,c,r,g)}function Ta(e,t,r){e._associatedReadableByteStreamController=t,e._view=r}function kr(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function ot(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function zn(e){return new at(e)}function Mn(e,t){e._reader._readIntoRequests.push(t)}function Ca(e,t,r){let u=e._reader._readIntoRequests.shift();r?u._closeSteps(t):u._chunkSteps(t)}function $n(e){return e._reader._readIntoRequests.length}function Or(e){let t=e._reader;return!(t===void 0||!Be(t))}class at{constructor(t){if(de(t,1,"ReadableStreamBYOBReader"),Rr(t,"First parameter"),Te(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Ae(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");un(this,t),this._readIntoRequests=new Q}get closed(){return Be(this)?this._closedPromise:p(Dt("closed"))}cancel(t=void 0){return Be(this)?this._ownerReadableStream===void 0?p(ze("cancel")):br(this,t):p(Dt("cancel"))}read(t){if(!Be(this))return p(Dt("read"));if(!ArrayBuffer.isView(t))return p(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return p(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return p(new TypeError("view's buffer must have non-zero byteLength"));if(Et(t.buffer),this._ownerReadableStream===void 0)return p(ze("read from"));let r,i,u=R((c,g)=>{r=c,i=g});return xn(this,t,{_chunkSteps:c=>r({value:c,done:!1}),_closeSteps:c=>r({value:c,done:!0}),_errorSteps:c=>i(c)}),u}releaseLock(){if(!Be(this))throw Dt("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ue(this)}}}Object.defineProperties(at.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(at.prototype,n.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Be(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof at}function xn(e,t,r){let i=e._ownerReadableStream;i._disturbed=!0,i._state==="errored"?r._errorSteps(i._storedError):ga(i._readableStreamController,t,r)}function Dt(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function it(e,t){let{highWaterMark:r}=e;if(r===void 0)return t;if(En(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function Wt(e){let{size:t}=e;return t||(()=>1)}function qt(e,t){fe(e,t);let r=e?.highWaterMark,i=e?.size;return{highWaterMark:r===void 0?void 0:wr(r),size:i===void 0?void 0:Ea(i,`${t} has member 'size' that`)}}function Ea(e,t){return ee(e,t),r=>wr(e(r))}function Pa(e,t){fe(e,t);let r=e?.abort,i=e?.close,u=e?.start,d=e?.type,c=e?.write;return{abort:r===void 0?void 0:Aa(r,e,`${t} has member 'abort' that`),close:i===void 0?void 0:va(i,e,`${t} has member 'close' that`),start:u===void 0?void 0:Ba(u,e,`${t} has member 'start' that`),write:c===void 0?void 0:ka(c,e,`${t} has member 'write' that`),type:d}}function Aa(e,t,r){return ee(e,r),i=>k(e,t,[i])}function va(e,t,r){return ee(e,r),()=>k(e,t,[])}function Ba(e,t,r){return ee(e,r),i=>L(e,t,[i])}function ka(e,t,r){return ee(e,r),(i,u)=>k(e,t,[i,u])}function Un(e,t){if(!xe(e))throw new TypeError(`${t} is not a WritableStream.`)}function Oa(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let Da=typeof AbortController=="function";function Wa(){if(Da)return new AbortController}class st{constructor(t={},r={}){t===void 0?t=null:bn(t,"First parameter");let i=qt(r,"Second parameter"),u=Pa(t,"First parameter");if(Nn(this),u.type!==void 0)throw new RangeError("Invalid type is specified");let c=Wt(i),g=it(i,1);Ya(this,u,g,c)}get locked(){if(!xe(this))throw Mt("locked");return Ue(this)}abort(t=void 0){return xe(this)?Ue(this)?p(new TypeError("Cannot abort a stream that already has a writer")):Ft(this,t):p(Mt("abort"))}close(){return xe(this)?Ue(this)?p(new TypeError("Cannot close a stream that already has a writer")):ie(this)?p(new TypeError("Cannot close an already-closing stream")):Hn(this):p(Mt("close"))}getWriter(){if(!xe(this))throw Mt("getWriter");return jn(this)}}Object.defineProperties(st.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(st.prototype,n.toStringTag,{value:"WritableStream",configurable:!0});function jn(e){return new lt(e)}function qa(e,t,r,i,u=1,d=()=>1){let c=Object.create(st.prototype);Nn(c);let g=Object.create(je.prototype);return Zn(c,g,e,t,r,i,u,d),c}function Nn(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new Q,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function xe(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof st}function Ue(e){return e._writer!==void 0}function Ft(e,t){var r;if(e._state==="closed"||e._state==="errored")return S(void 0);e._writableStreamController._abortReason=t,(r=e._writableStreamController._abortController)===null||r===void 0||r.abort();let i=e._state;if(i==="closed"||i==="errored")return S(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let u=!1;i==="erroring"&&(u=!0,t=void 0);let d=R((c,g)=>{e._pendingAbortRequest={_promise:void 0,_resolve:c,_reject:g,_reason:t,_wasAlreadyErroring:u}});return e._pendingAbortRequest._promise=d,u||Wr(e,t),d}function Hn(e){let t=e._state;if(t==="closed"||t==="errored")return p(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));let r=R((u,d)=>{let c={_resolve:u,_reject:d};e._closeRequest=c}),i=e._writer;return i!==void 0&&e._backpressure&&t==="writable"&&Ur(i),Qa(e._writableStreamController),r}function Fa(e){return R((r,i)=>{let u={_resolve:r,_reject:i};e._writeRequests.push(u)})}function Dr(e,t){if(e._state==="writable"){Wr(e,t);return}qr(e)}function Wr(e,t){let r=e._writableStreamController;e._state="erroring",e._storedError=t;let i=e._writer;i!==void 0&&Yn(i,t),!$a(e)&&r._started&&qr(e)}function qr(e){e._state="errored",e._writableStreamController[hn]();let t=e._storedError;if(e._writeRequests.forEach(u=>{u._reject(t)}),e._writeRequests=new Q,e._pendingAbortRequest===void 0){Lt(e);return}let r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring){r._reject(t),Lt(e);return}let i=e._writableStreamController[cn](r._reason);q(i,()=>{r._resolve(),Lt(e)},u=>{r._reject(u),Lt(e)})}function La(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Ia(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,Dr(e,t)}function za(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let r=e._writer;r!==void 0&&to(r)}function Ma(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),Dr(e,t)}function ie(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function $a(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function xa(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Ua(e){e._inFlightWriteRequest=e._writeRequests.shift()}function Lt(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;t!==void 0&&$r(t,e._storedError)}function Fr(e,t){let r=e._writer;r!==void 0&&t!==e._backpressure&&(t?ti(r):Ur(r)),e._backpressure=t}class lt{constructor(t){if(de(t,1,"WritableStreamDefaultWriter"),Un(t,"First parameter"),Ue(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;let r=t._state;if(r==="writable")!ie(t)&&t._backpressure?xt(this):ro(this),$t(this);else if(r==="erroring")xr(this,t._storedError),$t(this);else if(r==="closed")ro(this),Xa(this);else{let i=t._storedError;xr(this,i),eo(this,i)}}get closed(){return ke(this)?this._closedPromise:p(Oe("closed"))}get desiredSize(){if(!ke(this))throw Oe("desiredSize");if(this._ownerWritableStream===void 0)throw ut("desiredSize");return Va(this)}get ready(){return ke(this)?this._readyPromise:p(Oe("ready"))}abort(t=void 0){return ke(this)?this._ownerWritableStream===void 0?p(ut("abort")):ja(this,t):p(Oe("abort"))}close(){if(!ke(this))return p(Oe("close"));let t=this._ownerWritableStream;return t===void 0?p(ut("close")):ie(t)?p(new TypeError("Cannot close an already-closing stream")):Vn(this)}releaseLock(){if(!ke(this))throw Oe("releaseLock");this._ownerWritableStream!==void 0&&Qn(this)}write(t=void 0){return ke(this)?this._ownerWritableStream===void 0?p(ut("write to")):Gn(this,t):p(Oe("write"))}}Object.defineProperties(lt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(lt.prototype,n.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function ke(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof lt}function ja(e,t){let r=e._ownerWritableStream;return Ft(r,t)}function Vn(e){let t=e._ownerWritableStream;return Hn(t)}function Na(e){let t=e._ownerWritableStream,r=t._state;return ie(t)||r==="closed"?S(void 0):r==="errored"?p(t._storedError):Vn(e)}function Ha(e,t){e._closedPromiseState==="pending"?$r(e,t):ei(e,t)}function Yn(e,t){e._readyPromiseState==="pending"?no(e,t):ri(e,t)}function Va(e){let t=e._ownerWritableStream,r=t._state;return r==="errored"||r==="erroring"?null:r==="closed"?0:Kn(t._writableStreamController)}function Qn(e){let t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Yn(e,r),Ha(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function Gn(e,t){let r=e._ownerWritableStream,i=r._writableStreamController,u=Ga(i,t);if(r!==e._ownerWritableStream)return p(ut("write to"));let d=r._state;if(d==="errored")return p(r._storedError);if(ie(r)||d==="closed")return p(new TypeError("The stream is closing or closed and cannot be written to"));if(d==="erroring")return p(r._storedError);let c=Fa(r);return Ja(i,t,u),c}let Jn={};class je{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Lr(this))throw Mr("abortReason");return this._abortReason}get signal(){if(!Lr(this))throw Mr("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t=void 0){if(!Lr(this))throw Mr("error");this._controlledWritableStream._state==="writable"&&Xn(this,t)}[cn](t){let r=this._abortAlgorithm(t);return It(this),r}[hn](){_e(this)}}Object.defineProperties(je.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(je.prototype,n.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Lr(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof je}function Zn(e,t,r,i,u,d,c,g){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,_e(t),t._abortReason=void 0,t._abortController=Wa(),t._started=!1,t._strategySizeAlgorithm=g,t._strategyHWM=c,t._writeAlgorithm=i,t._closeAlgorithm=u,t._abortAlgorithm=d;let C=zr(t);Fr(e,C);let B=r(),D=S(B);q(D,()=>{t._started=!0,zt(t)},W=>{t._started=!0,Dr(e,W)})}function Ya(e,t,r,i){let u=Object.create(je.prototype),d=()=>{},c=()=>S(void 0),g=()=>S(void 0),C=()=>S(void 0);t.start!==void 0&&(d=()=>t.start(u)),t.write!==void 0&&(c=B=>t.write(B,u)),t.close!==void 0&&(g=()=>t.close()),t.abort!==void 0&&(C=B=>t.abort(B)),Zn(e,u,d,c,g,C,r,i)}function It(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Qa(e){Er(e,Jn,0),zt(e)}function Ga(e,t){try{return e._strategySizeAlgorithm(t)}catch(r){return Ir(e,r),1}}function Kn(e){return e._strategyHWM-e._queueTotalSize}function Ja(e,t,r){try{Er(e,t,r)}catch(u){Ir(e,u);return}let i=e._controlledWritableStream;if(!ie(i)&&i._state==="writable"){let u=zr(e);Fr(i,u)}zt(e)}function zt(e){let t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring"){qr(t);return}if(e._queue.length===0)return;let i=ya(e);i===Jn?Za(e):Ka(e,i)}function Ir(e,t){e._controlledWritableStream._state==="writable"&&Xn(e,t)}function Za(e){let t=e._controlledWritableStream;xa(t),Cr(e);let r=e._closeAlgorithm();It(e),q(r,()=>{za(t)},i=>{Ma(t,i)})}function Ka(e,t){let r=e._controlledWritableStream;Ua(r);let i=e._writeAlgorithm(t);q(i,()=>{La(r);let u=r._state;if(Cr(e),!ie(r)&&u==="writable"){let d=zr(e);Fr(r,d)}zt(e)},u=>{r._state==="writable"&&It(e),Ia(r,u)})}function zr(e){return Kn(e)<=0}function Xn(e,t){let r=e._controlledWritableStream;It(e),Wr(r,t)}function Mt(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Mr(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Oe(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function ut(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function $t(e){e._closedPromise=R((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function eo(e,t){$t(e),$r(e,t)}function Xa(e){$t(e),to(e)}function $r(e,t){e._closedPromise_reject!==void 0&&(O(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function ei(e,t){eo(e,t)}function to(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function xt(e){e._readyPromise=R((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function xr(e,t){xt(e),no(e,t)}function ro(e){xt(e),Ur(e)}function no(e,t){e._readyPromise_reject!==void 0&&(O(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function ti(e){xt(e)}function ri(e,t){xr(e,t)}function Ur(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let oo=typeof DOMException<"u"?DOMException:void 0;function ni(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function oi(){let e=function(r,i){this.message=r||"",this.name=i||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let ai=ni(oo)?oo:oi();function ao(e,t,r,i,u,d){let c=Me(e),g=jn(t);e._disturbed=!0;let C=!1,B=S(void 0);return R((D,W)=>{let $;if(d!==void 0){if($=()=>{let w=new ai("Aborted","AbortError"),A=[];i||A.push(()=>t._state==="writable"?Ft(t,w):S(void 0)),u||A.push(()=>e._state==="readable"?re(e,w):S(void 0)),H(()=>Promise.all(A.map(z=>z())),!0,w)},d.aborted){$();return}d.addEventListener("abort",$)}function ne(){return R((w,A)=>{function z(G){G?w():h(Ve(),z,A)}z(!1)})}function Ve(){return C?S(!0):h(g._readyPromise,()=>R((w,A)=>{et(c,{_chunkSteps:z=>{B=h(Gn(g,z),void 0,o),w(!1)},_closeSteps:()=>w(!0),_errorSteps:A})}))}if(ce(e,c._closedPromise,w=>{i?K(!0,w):H(()=>Ft(t,w),!0,w)}),ce(t,g._closedPromise,w=>{u?K(!0,w):H(()=>re(e,w),!0,w)}),j(e,c._closedPromise,()=>{r?K():H(()=>Na(g))}),ie(t)||t._state==="closed"){let w=new TypeError("the destination writable stream closed before all data could be piped to it");u?K(!0,w):H(()=>re(e,w),!0,w)}O(ne());function Ce(){let w=B;return h(B,()=>w!==B?Ce():void 0)}function ce(w,A,z){w._state==="errored"?z(w._storedError):T(A,z)}function j(w,A,z){w._state==="closed"?z():v(A,z)}function H(w,A,z){if(C)return;C=!0,t._state==="writable"&&!ie(t)?v(Ce(),G):G();function G(){q(w(),()=>he(A,z),Ye=>he(!0,Ye))}}function K(w,A){C||(C=!0,t._state==="writable"&&!ie(t)?v(Ce(),()=>he(w,A)):he(w,A))}function he(w,A){Qn(g),ue(c),d!==void 0&&d.removeEventListener("abort",$),w?W(A):D(void 0)}})}class Ne{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Ut(this))throw Ht("desiredSize");return jr(this)}close(){if(!Ut(this))throw Ht("close");if(!He(this))throw new TypeError("The stream is not in a state that permits close");dt(this)}enqueue(t=void 0){if(!Ut(this))throw Ht("enqueue");if(!He(this))throw new TypeError("The stream is not in a state that permits enqueue");return Nt(this,t)}error(t=void 0){if(!Ut(this))throw Ht("error");Se(this,t)}[gr](t){_e(this);let r=this._cancelAlgorithm(t);return jt(this),r}[_r](t){let r=this._controlledReadableStream;if(this._queue.length>0){let i=Cr(this);this._closeRequested&&this._queue.length===0?(jt(this),ct(r)):ft(this),t._chunkSteps(i)}else gn(r,t),ft(this)}}Object.defineProperties(Ne.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Ne.prototype,n.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Ut(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof Ne}function ft(e){if(!io(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let r=e._pullAlgorithm();q(r,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ft(e))},i=>{Se(e,i)})}function io(e){let t=e._controlledReadableStream;return!He(e)||!e._started?!1:!!(Te(t)&&Tt(t)>0||jr(e)>0)}function jt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function dt(e){if(!He(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(jt(e),ct(t))}function Nt(e,t){if(!He(e))return;let r=e._controlledReadableStream;if(Te(r)&&Tt(r)>0)Tr(r,t,!1);else{let i;try{i=e._strategySizeAlgorithm(t)}catch(u){throw Se(e,u),u}try{Er(e,t,i)}catch(u){throw Se(e,u),u}}ft(e)}function Se(e,t){let r=e._controlledReadableStream;r._state==="readable"&&(_e(e),jt(e),fo(r,t))}function jr(e){let t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function ii(e){return!io(e)}function He(e){let t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function so(e,t,r,i,u,d,c){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,_e(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=c,t._strategyHWM=d,t._pullAlgorithm=i,t._cancelAlgorithm=u,e._readableStreamController=t;let g=r();q(S(g),()=>{t._started=!0,ft(t)},C=>{Se(t,C)})}function si(e,t,r,i){let u=Object.create(Ne.prototype),d=()=>{},c=()=>S(void 0),g=()=>S(void 0);t.start!==void 0&&(d=()=>t.start(u)),t.pull!==void 0&&(c=()=>t.pull(u)),t.cancel!==void 0&&(g=C=>t.cancel(C)),so(e,u,d,c,g,r,i)}function Ht(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function li(e,t){return Ae(e._readableStreamController)?fi(e):ui(e)}function ui(e,t){let r=Me(e),i=!1,u=!1,d=!1,c=!1,g,C,B,D,W,$=R(j=>{W=j});function ne(){return i?(u=!0,S(void 0)):(i=!0,et(r,{_chunkSteps:H=>{P(()=>{u=!1;let K=H,he=H;d||Nt(B._readableStreamController,K),c||Nt(D._readableStreamController,he),i=!1,u&&ne()})},_closeSteps:()=>{i=!1,d||dt(B._readableStreamController),c||dt(D._readableStreamController),(!d||!c)&&W(void 0)},_errorSteps:()=>{i=!1}}),S(void 0))}function Ve(j){if(d=!0,g=j,c){let H=tt([g,C]),K=re(e,H);W(K)}return $}function Ce(j){if(c=!0,C=j,d){let H=tt([g,C]),K=re(e,H);W(K)}return $}function ce(){}return B=Nr(ce,ne,Ve),D=Nr(ce,ne,Ce),T(r._closedPromise,j=>{Se(B._readableStreamController,j),Se(D._readableStreamController,j),(!d||!c)&&W(void 0)}),[B,D]}function fi(e){let t=Me(e),r=!1,i=!1,u=!1,d=!1,c=!1,g,C,B,D,W,$=R(w=>{W=w});function ne(w){T(w._closedPromise,A=>{w===t&&(te(B._readableStreamController,A),te(D._readableStreamController,A),(!d||!c)&&W(void 0))})}function Ve(){Be(t)&&(ue(t),t=Me(e),ne(t)),et(t,{_chunkSteps:A=>{P(()=>{i=!1,u=!1;let z=A,G=A;if(!d&&!c)try{G=vn(A)}catch(Ye){te(B._readableStreamController,Ye),te(D._readableStreamController,Ye),W(re(e,Ye));return}d||Bt(B._readableStreamController,z),c||Bt(D._readableStreamController,G),r=!1,i?ce():u&&j()})},_closeSteps:()=>{r=!1,d||nt(B._readableStreamController),c||nt(D._readableStreamController),B._readableStreamController._pendingPullIntos.length>0&&kt(B._readableStreamController,0),D._readableStreamController._pendingPullIntos.length>0&&kt(D._readableStreamController,0),(!d||!c)&&W(void 0)},_errorSteps:()=>{r=!1}})}function Ce(w,A){ge(t)&&(ue(t),t=zn(e),ne(t));let z=A?D:B,G=A?B:D;xn(t,w,{_chunkSteps:Qe=>{P(()=>{i=!1,u=!1;let Ge=A?c:d;if(A?d:c)Ge||Ot(z._readableStreamController,Qe);else{let Co;try{Co=vn(Qe)}catch(Vr){te(z._readableStreamController,Vr),te(G._readableStreamController,Vr),W(re(e,Vr));return}Ge||Ot(z._readableStreamController,Qe),Bt(G._readableStreamController,Co)}r=!1,i?ce():u&&j()})},_closeSteps:Qe=>{r=!1;let Ge=A?c:d,er=A?d:c;Ge||nt(z._readableStreamController),er||nt(G._readableStreamController),Qe!==void 0&&(Ge||Ot(z._readableStreamController,Qe),!er&&G._readableStreamController._pendingPullIntos.length>0&&kt(G._readableStreamController,0)),(!Ge||!er)&&W(void 0)},_errorSteps:()=>{r=!1}})}function ce(){if(r)return i=!0,S(void 0);r=!0;let w=Br(B._readableStreamController);return w===null?Ve():Ce(w._view,!1),S(void 0)}function j(){if(r)return u=!0,S(void 0);r=!0;let w=Br(D._readableStreamController);return w===null?Ve():Ce(w._view,!0),S(void 0)}function H(w){if(d=!0,g=w,c){let A=tt([g,C]),z=re(e,A);W(z)}return $}function K(w){if(c=!0,C=w,d){let A=tt([g,C]),z=re(e,A);W(z)}return $}function he(){}return B=uo(he,ce,H),D=uo(he,j,K),ne(t),[B,D]}function di(e,t){fe(e,t);let r=e,i=r?.autoAllocateChunkSize,u=r?.cancel,d=r?.pull,c=r?.start,g=r?.type;return{autoAllocateChunkSize:i===void 0?void 0:yn(i,`${t} has member 'autoAllocateChunkSize' that`),cancel:u===void 0?void 0:ci(u,r,`${t} has member 'cancel' that`),pull:d===void 0?void 0:hi(d,r,`${t} has member 'pull' that`),start:c===void 0?void 0:mi(c,r,`${t} has member 'start' that`),type:g===void 0?void 0:bi(g,`${t} has member 'type' that`)}}function ci(e,t,r){return ee(e,r),i=>k(e,t,[i])}function hi(e,t,r){return ee(e,r),i=>k(e,t,[i])}function mi(e,t,r){return ee(e,r),i=>L(e,t,[i])}function bi(e,t){if(e=`${e}`,e!=="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function pi(e,t){fe(e,t);let r=e?.mode;return{mode:r===void 0?void 0:yi(r,`${t} has member 'mode' that`)}}function yi(e,t){if(e=`${e}`,e!=="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function gi(e,t){return fe(e,t),{preventCancel:!!e?.preventCancel}}function lo(e,t){fe(e,t);let r=e?.preventAbort,i=e?.preventCancel,u=e?.preventClose,d=e?.signal;return d!==void 0&&_i(d,`${t} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!i,preventClose:!!u,signal:d}}function _i(e,t){if(!Oa(e))throw new TypeError(`${t} is not an AbortSignal.`)}function Si(e,t){fe(e,t);let r=e?.readable;Sr(r,"readable","ReadableWritablePair"),Rr(r,`${t} has member 'readable' that`);let i=e?.writable;return Sr(i,"writable","ReadableWritablePair"),Un(i,`${t} has member 'writable' that`),{readable:r,writable:i}}class we{constructor(t={},r={}){t===void 0?t=null:bn(t,"First parameter");let i=qt(r,"Second parameter"),u=di(t,"First parameter");if(Hr(this),u.type==="bytes"){if(i.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let d=it(i,0);Ra(this,u,d)}else{let d=Wt(i),c=it(i,1);si(this,u,c,d)}}get locked(){if(!Re(this))throw De("locked");return Te(this)}cancel(t=void 0){return Re(this)?Te(this)?p(new TypeError("Cannot cancel a stream that already has a reader")):re(this,t):p(De("cancel"))}getReader(t=void 0){if(!Re(this))throw De("getReader");return pi(t,"First parameter").mode===void 0?Me(this):zn(this)}pipeThrough(t,r={}){if(!Re(this))throw De("pipeThrough");de(t,1,"pipeThrough");let i=Si(t,"First parameter"),u=lo(r,"Second parameter");if(Te(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Ue(i.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let d=ao(this,i.writable,u.preventClose,u.preventAbort,u.preventCancel,u.signal);return O(d),i.readable}pipeTo(t,r={}){if(!Re(this))return p(De("pipeTo"));if(t===void 0)return p("Parameter 1 is required in 'pipeTo'.");if(!xe(t))return p(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let i;try{i=lo(r,"Second parameter")}catch(u){return p(u)}return Te(this)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Ue(t)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):ao(this,t,i.preventClose,i.preventAbort,i.preventCancel,i.signal)}tee(){if(!Re(this))throw De("tee");let t=li(this);return tt(t)}values(t=void 0){if(!Re(this))throw De("values");let r=gi(t,"First parameter");return ba(this,r.preventCancel)}}Object.defineProperties(we.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(we.prototype,n.toStringTag,{value:"ReadableStream",configurable:!0}),typeof n.asyncIterator=="symbol"&&Object.defineProperty(we.prototype,n.asyncIterator,{value:we.prototype.values,writable:!0,configurable:!0});function Nr(e,t,r,i=1,u=()=>1){let d=Object.create(we.prototype);Hr(d);let c=Object.create(Ne.prototype);return so(d,c,e,t,r,i,u),d}function uo(e,t,r){let i=Object.create(we.prototype);Hr(i);let u=Object.create($e.prototype);return In(i,u,e,t,r,0,void 0),i}function Hr(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Re(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof we}function Te(e){return e._reader!==void 0}function re(e,t){if(e._disturbed=!0,e._state==="closed")return S(void 0);if(e._state==="errored")return p(e._storedError);ct(e);let r=e._reader;r!==void 0&&Be(r)&&(r._readIntoRequests.forEach(u=>{u._closeSteps(void 0)}),r._readIntoRequests=new Q);let i=e._readableStreamController[gr](t);return I(i,o)}function ct(e){e._state="closed";let t=e._reader;t!==void 0&&(dn(t),ge(t)&&(t._readRequests.forEach(r=>{r._closeSteps()}),t._readRequests=new Q))}function fo(e,t){e._state="errored",e._storedError=t;let r=e._reader;r!==void 0&&(yr(r,t),ge(r)?(r._readRequests.forEach(i=>{i._errorSteps(t)}),r._readRequests=new Q):(r._readIntoRequests.forEach(i=>{i._errorSteps(t)}),r._readIntoRequests=new Q))}function De(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function co(e,t){fe(e,t);let r=e?.highWaterMark;return Sr(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:wr(r)}}let ho=e=>e.byteLength;try{Object.defineProperty(ho,"name",{value:"size",configurable:!0})}catch{}class Vt{constructor(t){de(t,1,"ByteLengthQueuingStrategy"),t=co(t,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!bo(this))throw mo("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!bo(this))throw mo("size");return ho}}Object.defineProperties(Vt.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Vt.prototype,n.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function mo(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function bo(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Vt}let po=()=>1;try{Object.defineProperty(po,"name",{value:"size",configurable:!0})}catch{}class Yt{constructor(t){de(t,1,"CountQueuingStrategy"),t=co(t,"First parameter"),this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!go(this))throw yo("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!go(this))throw yo("size");return po}}Object.defineProperties(Yt.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Yt.prototype,n.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function yo(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function go(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Yt}function wi(e,t){fe(e,t);let r=e?.flush,i=e?.readableType,u=e?.start,d=e?.transform,c=e?.writableType;return{flush:r===void 0?void 0:Ri(r,e,`${t} has member 'flush' that`),readableType:i,start:u===void 0?void 0:Ti(u,e,`${t} has member 'start' that`),transform:d===void 0?void 0:Ci(d,e,`${t} has member 'transform' that`),writableType:c}}function Ri(e,t,r){return ee(e,r),i=>k(e,t,[i])}function Ti(e,t,r){return ee(e,r),i=>L(e,t,[i])}function Ci(e,t,r){return ee(e,r),(i,u)=>k(e,t,[i,u])}class Qt{constructor(t={},r={},i={}){t===void 0&&(t=null);let u=qt(r,"Second parameter"),d=qt(i,"Third parameter"),c=wi(t,"First parameter");if(c.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(c.writableType!==void 0)throw new RangeError("Invalid writableType specified");let g=it(d,0),C=Wt(d),B=it(u,1),D=Wt(u),W,$=R(ne=>{W=ne});Ei(this,$,B,D,g,C),Ai(this,c),c.start!==void 0?W(c.start(this._transformStreamController)):W(void 0)}get readable(){if(!_o(this))throw To("readable");return this._readable}get writable(){if(!_o(this))throw To("writable");return this._writable}}Object.defineProperties(Qt.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Qt.prototype,n.toStringTag,{value:"TransformStream",configurable:!0});function Ei(e,t,r,i,u,d){function c(){return t}function g($){return ki(e,$)}function C($){return Oi(e,$)}function B(){return Di(e)}e._writable=qa(c,g,B,C,r,i);function D(){return Wi(e)}function W($){return Jt(e,$),S(void 0)}e._readable=Nr(c,D,W,u,d),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Zt(e,!0),e._transformStreamController=void 0}function _o(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof Qt}function Gt(e,t){Se(e._readable._readableStreamController,t),Jt(e,t)}function Jt(e,t){So(e._transformStreamController),Ir(e._writable._writableStreamController,t),e._backpressure&&Zt(e,!1)}function Zt(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=R(r=>{e._backpressureChangePromise_resolve=r}),e._backpressure=t}class ht{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Kt(this))throw Xt("desiredSize");let t=this._controlledTransformStream._readable._readableStreamController;return jr(t)}enqueue(t=void 0){if(!Kt(this))throw Xt("enqueue");wo(this,t)}error(t=void 0){if(!Kt(this))throw Xt("error");vi(this,t)}terminate(){if(!Kt(this))throw Xt("terminate");Bi(this)}}Object.defineProperties(ht.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(ht.prototype,n.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Kt(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof ht}function Pi(e,t,r,i){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=r,t._flushAlgorithm=i}function Ai(e,t){let r=Object.create(ht.prototype),i=d=>{try{return wo(r,d),S(void 0)}catch(c){return p(c)}},u=()=>S(void 0);t.transform!==void 0&&(i=d=>t.transform(d,r)),t.flush!==void 0&&(u=()=>t.flush(r)),Pi(e,r,i,u)}function So(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function wo(e,t){let r=e._controlledTransformStream,i=r._readable._readableStreamController;if(!He(i))throw new TypeError("Readable side is not in a state that permits enqueue");try{Nt(i,t)}catch(d){throw Jt(r,d),r._readable._storedError}ii(i)!==r._backpressure&&Zt(r,!0)}function vi(e,t){Gt(e._controlledTransformStream,t)}function Ro(e,t){let r=e._transformAlgorithm(t);return I(r,void 0,i=>{throw Gt(e._controlledTransformStream,i),i})}function Bi(e){let t=e._controlledTransformStream,r=t._readable._readableStreamController;dt(r);let i=new TypeError("TransformStream terminated");Jt(t,i)}function ki(e,t){let r=e._transformStreamController;if(e._backpressure){let i=e._backpressureChangePromise;return I(i,()=>{let u=e._writable;if(u._state==="erroring")throw u._storedError;return Ro(r,t)})}return Ro(r,t)}function Oi(e,t){return Gt(e,t),S(void 0)}function Di(e){let t=e._readable,r=e._transformStreamController,i=r._flushAlgorithm();return So(r),I(i,()=>{if(t._state==="errored")throw t._storedError;dt(t._readableStreamController)},u=>{throw Gt(e,u),t._storedError})}function Wi(e){return Zt(e,!1),e._backpressureChangePromise}function Xt(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function To(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}a.ByteLengthQueuingStrategy=Vt,a.CountQueuingStrategy=Yt,a.ReadableByteStreamController=$e,a.ReadableStream=we,a.ReadableStreamBYOBReader=at,a.ReadableStreamBYOBRequest=rt,a.ReadableStreamDefaultController=Ne,a.ReadableStreamDefaultReader=Xe,a.TransformStream=Qt,a.TransformStreamDefaultController=ht,a.WritableStream=st,a.WritableStreamDefaultController=je,a.WritableStreamDefaultWriter=lt,Object.defineProperty(a,"__esModule",{value:!0})})});var ko=Yr(()=>{if(!globalThis.ReadableStream)try{let a=require("node:process"),{emitWarning:n}=a;try{a.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),a.emitWarning=n}catch(o){throw a.emitWarning=n,o}}catch{Object.assign(globalThis,Bo())}try{let{Blob:a}=require("buffer");a&&!a.prototype.stream&&(a.prototype.stream=function(o){let s=0,l=this;return new ReadableStream({type:"bytes",async pull(f){let _=await l.slice(s,Math.min(l.size,s+65536)).arrayBuffer();s+=_.byteLength,f.enqueue(new Uint8Array(_)),s===l.size&&f.close()}})})}catch{}});async function*Qr(a,n=!0){for(let o of a)if("stream"in o)yield*o.stream();else if(ArrayBuffer.isView(o))if(n){let s=o.byteOffset,l=o.byteOffset+o.byteLength;for(;s!==l;){let f=Math.min(l-s,Oo),m=o.buffer.slice(s,s+f);s+=m.byteLength,yield new Uint8Array(m)}}else yield o;else{let s=0,l=o;for(;s!==l.size;){let m=await l.slice(s,Math.min(l.size,s+Oo)).arrayBuffer();s+=m.byteLength,yield new Uint8Array(m)}}}var ys,Oo,Do,xi,me,bt=mt(()=>{ys=Ee(ko(),1);Oo=65536;Do=class Gr{#e=[];#t="";#r=0;#n="transparent";constructor(n=[],o={}){if(typeof n!="object"||n===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof n[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof o!="object"&&typeof o!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");o===null&&(o={});let s=new TextEncoder;for(let f of n){let m;ArrayBuffer.isView(f)?m=new Uint8Array(f.buffer.slice(f.byteOffset,f.byteOffset+f.byteLength)):f instanceof ArrayBuffer?m=new Uint8Array(f.slice(0)):f instanceof Gr?m=f:m=s.encode(`${f}`),this.#r+=ArrayBuffer.isView(m)?m.byteLength:m.size,this.#e.push(m)}this.#n=`${o.endings===void 0?"transparent":o.endings}`;let l=o.type===void 0?"":String(o.type);this.#t=/^[\x20-\x7E]*$/.test(l)?l:""}get size(){return this.#r}get type(){return this.#t}async text(){let n=new TextDecoder,o="";for await(let s of Qr(this.#e,!1))o+=n.decode(s,{stream:!0});return o+=n.decode(),o}async arrayBuffer(){let n=new Uint8Array(this.size),o=0;for await(let s of Qr(this.#e,!1))n.set(s,o),o+=s.length;return n.buffer}stream(){let n=Qr(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(o){let s=await n.next();s.done?o.close():o.enqueue(s.value)},async cancel(){await n.return()}})}slice(n=0,o=this.size,s=""){let{size:l}=this,f=n<0?Math.max(l+n,0):Math.min(n,l),m=o<0?Math.max(l+o,0):Math.min(o,l),_=Math.max(m-f,0),y=this.#e,b=[],E=0;for(let S of y){if(E>=_)break;let p=ArrayBuffer.isView(S)?S.byteLength:S.size;if(f&&p<=f)f-=p,m-=p;else{let h;ArrayBuffer.isView(S)?(h=S.subarray(f,Math.min(p,m)),E+=h.byteLength):(h=S.slice(f,Math.min(p,m)),E+=h.size),m-=p,b.push(h),f=0}}let R=new Gr([],{type:String(s).toLowerCase()});return R.#r=_,R.#e=b,R}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](n){return n&&typeof n=="object"&&typeof n.constructor=="function"&&(typeof n.stream=="function"||typeof n.arrayBuffer=="function")&&/^(Blob|File)$/.test(n[Symbol.toStringTag])}};Object.defineProperties(Do.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});xi=Do,me=xi});var Ui,ji,Je,Jr=mt(()=>{bt();Ui=class extends me{#e=0;#t="";constructor(n,o,s={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(n,s),s===null&&(s={});let l=s.lastModified===void 0?Date.now():Number(s.lastModified);Number.isNaN(l)||(this.#e=l),this.#t=String(o)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](n){return!!n&&n instanceof me&&/^(File)$/.test(n[Symbol.toStringTag])}},ji=Ui,Je=ji});function Fo(a,n=me){var o=`${Wo()}${Wo()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],l=`--${o}\r
Content-Disposition: form-data; name="`;return a.forEach((f,m)=>typeof f=="string"?s.push(l+Zr(m)+`"\r
\r
${f.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(l+Zr(m)+`"; filename="${Zr(f.name,1)}"\r
Content-Type: ${f.type||"application/octet-stream"}\r
\r
`,f,`\r
`)),s.push(`--${o}--`),new n(s,{type:"multipart/form-data; boundary="+o})}var pt,Ni,Hi,Wo,Vi,qo,Zr,We,qe,nr=mt(()=>{bt();Jr();({toStringTag:pt,iterator:Ni,hasInstance:Hi}=Symbol),Wo=Math.random,Vi="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),qo=(a,n,o)=>(a+="",/^(Blob|File)$/.test(n&&n[pt])?[(o=o!==void 0?o+"":n[pt]=="File"?n.name:"blob",a),n.name!==o||n[pt]=="blob"?new Je([n],o,n):n]:[a,n+""]),Zr=(a,n)=>(n?a:a.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),We=(a,n,o)=>{if(n.length<o)throw new TypeError(`Failed to execute '${a}' on 'FormData': ${o} arguments required, but only ${n.length} present.`)},qe=class{#e=[];constructor(...n){if(n.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[pt](){return"FormData"}[Ni](){return this.entries()}static[Hi](n){return n&&typeof n=="object"&&n[pt]==="FormData"&&!Vi.some(o=>typeof n[o]!="function")}append(...n){We("append",arguments,2),this.#e.push(qo(...n))}delete(n){We("delete",arguments,1),n+="",this.#e=this.#e.filter(([o])=>o!==n)}get(n){We("get",arguments,1),n+="";for(var o=this.#e,s=o.length,l=0;l<s;l++)if(o[l][0]===n)return o[l][1];return null}getAll(n,o){return We("getAll",arguments,1),o=[],n+="",this.#e.forEach(s=>s[0]===n&&o.push(s[1])),o}has(n){return We("has",arguments,1),n+="",this.#e.some(o=>o[0]===n)}forEach(n,o){We("forEach",arguments,1);for(var[s,l]of this)n.call(o,l,s,this)}set(...n){We("set",arguments,2);var o=[],s=!0;n=qo(...n),this.#e.forEach(l=>{l[0]===n[0]?s&&(s=!o.push(n)):o.push(l)}),s&&o.push(n),this.#e=o}*entries(){yield*this.#e}*keys(){for(var[n]of this)yield n}*values(){for(var[,n]of this)yield n}}});var $o=Yr((ks,Mo)=>{if(!globalThis.DOMException)try{let{MessageChannel:a}=require("worker_threads"),n=new a().port1,o=new ArrayBuffer;n.postMessage(o,[o,o])}catch(a){a.constructor.name==="DOMException"&&(globalThis.DOMException=a.constructor)}Mo.exports=globalThis.DOMException});var gt,xo,Yi,ar,Xr=mt(()=>{gt=require("node:fs"),xo=Ee($o(),1);Jr();bt();({stat:Yi}=gt.promises),ar=class{#e;#t;constructor(n){this.#e=n.path,this.#t=n.start,this.size=n.size,this.lastModified=n.lastModified}slice(n,o){return new ar({path:this.#e,lastModified:this.lastModified,size:o-n,start:this.#t+n})}async*stream(){let{mtimeMs:n}=await Yi(this.#e);if(n>this.lastModified)throw new xo.default("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,gt.createReadStream)(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}});var jo={};Eo(jo,{toFormData:()=>es});function Xi(a){let n=a.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!n)return;let o=n[2]||n[3]||"",s=o.slice(o.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(l,f)=>String.fromCharCode(f)),s}async function es(a,n){if(!/multipart/i.test(n))throw new TypeError("Failed to fetch");let o=n.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!o)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new en(o[1]||o[2]),l,f,m,_,y,b,E=[],R=new qe,S=T=>{m+=v.decode(T,{stream:!0})},p=T=>{E.push(T)},h=()=>{let T=new Je(E,b,{type:y});R.append(_,T)},q=()=>{R.append(_,m)},v=new TextDecoder("utf-8");v.decode(),s.onPartBegin=function(){s.onPartData=S,s.onPartEnd=q,l="",f="",m="",_="",y="",b=null,E.length=0},s.onHeaderField=function(T){l+=v.decode(T,{stream:!0})},s.onHeaderValue=function(T){f+=v.decode(T,{stream:!0})},s.onHeaderEnd=function(){if(f+=v.decode(),l=l.toLowerCase(),l==="content-disposition"){let T=f.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);T&&(_=T[2]||T[3]||""),b=Xi(f),b&&(s.onPartData=p,s.onPartEnd=h)}else l==="content-type"&&(y=f);f="",l=""};for await(let T of a)s.write(T);return s.end(),R}var se,M,Uo,Pe,ir,sr,Qi,_t,Gi,Ji,Zi,Ki,Fe,en,No=mt(()=>{Xr();nr();se=0,M={START_BOUNDARY:se++,HEADER_FIELD_START:se++,HEADER_FIELD:se++,HEADER_VALUE_START:se++,HEADER_VALUE:se++,HEADER_VALUE_ALMOST_DONE:se++,HEADERS_ALMOST_DONE:se++,PART_DATA_START:se++,PART_DATA:se++,END:se++},Uo=1,Pe={PART_BOUNDARY:Uo,LAST_BOUNDARY:Uo*=2},ir=10,sr=13,Qi=32,_t=45,Gi=58,Ji=97,Zi=122,Ki=a=>a|32,Fe=()=>{},en=class{constructor(n){this.index=0,this.flags=0,this.onHeaderEnd=Fe,this.onHeaderField=Fe,this.onHeadersEnd=Fe,this.onHeaderValue=Fe,this.onPartBegin=Fe,this.onPartData=Fe,this.onPartEnd=Fe,this.boundaryChars={},n=`\r
--`+n;let o=new Uint8Array(n.length);for(let s=0;s<n.length;s++)o[s]=n.charCodeAt(s),this.boundaryChars[o[s]]=!0;this.boundary=o,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=M.START_BOUNDARY}write(n){let o=0,s=n.length,l=this.index,{lookbehind:f,boundary:m,boundaryChars:_,index:y,state:b,flags:E}=this,R=this.boundary.length,S=R-1,p=n.length,h,q,v=P=>{this[P+"Mark"]=o},T=P=>{delete this[P+"Mark"]},I=(P,L,k,ae)=>{(L===void 0||L!==k)&&this[P](ae&&ae.subarray(L,k))},O=(P,L)=>{let k=P+"Mark";k in this&&(L?(I(P,this[k],o,n),delete this[k]):(I(P,this[k],n.length,n),this[k]=0))};for(o=0;o<s;o++)switch(h=n[o],b){case M.START_BOUNDARY:if(y===m.length-2){if(h===_t)E|=Pe.LAST_BOUNDARY;else if(h!==sr)return;y++;break}else if(y-1===m.length-2){if(E&Pe.LAST_BOUNDARY&&h===_t)b=M.END,E=0;else if(!(E&Pe.LAST_BOUNDARY)&&h===ir)y=0,I("onPartBegin"),b=M.HEADER_FIELD_START;else return;break}h!==m[y+2]&&(y=-2),h===m[y+2]&&y++;break;case M.HEADER_FIELD_START:b=M.HEADER_FIELD,v("onHeaderField"),y=0;case M.HEADER_FIELD:if(h===sr){T("onHeaderField"),b=M.HEADERS_ALMOST_DONE;break}if(y++,h===_t)break;if(h===Gi){if(y===1)return;O("onHeaderField",!0),b=M.HEADER_VALUE_START;break}if(q=Ki(h),q<Ji||q>Zi)return;break;case M.HEADER_VALUE_START:if(h===Qi)break;v("onHeaderValue"),b=M.HEADER_VALUE;case M.HEADER_VALUE:h===sr&&(O("onHeaderValue",!0),I("onHeaderEnd"),b=M.HEADER_VALUE_ALMOST_DONE);break;case M.HEADER_VALUE_ALMOST_DONE:if(h!==ir)return;b=M.HEADER_FIELD_START;break;case M.HEADERS_ALMOST_DONE:if(h!==ir)return;I("onHeadersEnd"),b=M.PART_DATA_START;break;case M.PART_DATA_START:b=M.PART_DATA,v("onPartData");case M.PART_DATA:if(l=y,y===0){for(o+=S;o<p&&!(n[o]in _);)o+=R;o-=S,h=n[o]}if(y<m.length)m[y]===h?(y===0&&O("onPartData",!0),y++):y=0;else if(y===m.length)y++,h===sr?E|=Pe.PART_BOUNDARY:h===_t?E|=Pe.LAST_BOUNDARY:y=0;else if(y-1===m.length)if(E&Pe.PART_BOUNDARY){if(y=0,h===ir){E&=~Pe.PART_BOUNDARY,I("onPartEnd"),I("onPartBegin"),b=M.HEADER_FIELD_START;break}}else E&Pe.LAST_BOUNDARY&&h===_t?(I("onPartEnd"),b=M.END,E=0):y=0;if(y>0)f[y-1]=h;else if(l>0){let P=new Uint8Array(f.buffer,f.byteOffset,f.byteLength);I("onPartData",0,l,P),l=0,v("onPartData"),o--}break;case M.END:break;default:throw new Error(`Unexpected state entered: ${b}`)}O("onHeaderField"),O("onHeaderValue"),O("onPartData"),this.index=y,this.state=b,this.flags=E}end(){if(this.state===M.HEADER_FIELD_START&&this.index===0||this.state===M.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==M.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var ds={};Eo(ds,{default:()=>la});module.exports=Mi(ds);var F=require("@raycast/api"),Ie=require("react");var aa=Ee(require("node:http"),1),ia=Ee(require("node:https"),1),Le=Ee(require("node:zlib"),1),Z=Ee(require("node:stream"),1),Rt=require("node:buffer");function $i(a){if(!/^data:/i.test(a))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');a=a.replace(/\r?\n/g,"");let n=a.indexOf(",");if(n===-1||n<=4)throw new TypeError("malformed data: URI");let o=a.substring(5,n).split(";"),s="",l=!1,f=o[0]||"text/plain",m=f;for(let E=1;E<o.length;E++)o[E]==="base64"?l=!0:o[E]&&(m+=`;${o[E]}`,o[E].indexOf("charset=")===0&&(s=o[E].substring(8)));!o[0]&&!s.length&&(m+=";charset=US-ASCII",s="US-ASCII");let _=l?"base64":"ascii",y=unescape(a.substring(n+1)),b=Buffer.from(y,_);return b.type=f,b.typeFull=m,b.charset=s,b}var Ao=$i;var X=Ee(require("node:stream"),1),pe=require("node:util"),J=require("node:buffer");bt();nr();var be=class extends Error{constructor(n,o){super(n),Error.captureStackTrace(this,this.constructor),this.type=o}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var V=class extends be{constructor(n,o,s){super(n,o),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var or=Symbol.toStringTag,Kr=a=>typeof a=="object"&&typeof a.append=="function"&&typeof a.delete=="function"&&typeof a.get=="function"&&typeof a.getAll=="function"&&typeof a.has=="function"&&typeof a.set=="function"&&typeof a.sort=="function"&&a[or]==="URLSearchParams",yt=a=>a&&typeof a=="object"&&typeof a.arrayBuffer=="function"&&typeof a.type=="string"&&typeof a.stream=="function"&&typeof a.constructor=="function"&&/^(Blob|File)$/.test(a[or]),Lo=a=>typeof a=="object"&&(a[or]==="AbortSignal"||a[or]==="EventTarget"),Io=(a,n)=>{let o=new URL(n).hostname,s=new URL(a).hostname;return o===s||o.endsWith(`.${s}`)},zo=(a,n)=>{let o=new URL(n).protocol,s=new URL(a).protocol;return o===s};var ts=(0,pe.promisify)(X.default.pipeline),Y=Symbol("Body internals"),le=class{constructor(n,{size:o=0}={}){let s=null;n===null?n=null:Kr(n)?n=J.Buffer.from(n.toString()):yt(n)||J.Buffer.isBuffer(n)||(pe.types.isAnyArrayBuffer(n)?n=J.Buffer.from(n):ArrayBuffer.isView(n)?n=J.Buffer.from(n.buffer,n.byteOffset,n.byteLength):n instanceof X.default||(n instanceof qe?(n=Fo(n),s=n.type.split("=")[1]):n=J.Buffer.from(String(n))));let l=n;J.Buffer.isBuffer(n)?l=X.default.Readable.from(n):yt(n)&&(l=X.default.Readable.from(n.stream())),this[Y]={body:n,stream:l,boundary:s,disturbed:!1,error:null},this.size=o,n instanceof X.default&&n.on("error",f=>{let m=f instanceof be?f:new V(`Invalid response body while trying to fetch ${this.url}: ${f.message}`,"system",f);this[Y].error=m})}get body(){return this[Y].stream}get bodyUsed(){return this[Y].disturbed}async arrayBuffer(){let{buffer:n,byteOffset:o,byteLength:s}=await tn(this);return n.slice(o,o+s)}async formData(){let n=this.headers.get("content-type");if(n.startsWith("application/x-www-form-urlencoded")){let s=new qe,l=new URLSearchParams(await this.text());for(let[f,m]of l)s.append(f,m);return s}let{toFormData:o}=await Promise.resolve().then(()=>(No(),jo));return o(this.body,n)}async blob(){let n=this.headers&&this.headers.get("content-type")||this[Y].body&&this[Y].body.type||"",o=await this.arrayBuffer();return new me([o],{type:n})}async json(){let n=await this.text();return JSON.parse(n)}async text(){let n=await tn(this);return new TextDecoder().decode(n)}buffer(){return tn(this)}};le.prototype.buffer=(0,pe.deprecate)(le.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(le.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,pe.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function tn(a){if(a[Y].disturbed)throw new TypeError(`body used already for: ${a.url}`);if(a[Y].disturbed=!0,a[Y].error)throw a[Y].error;let{body:n}=a;if(n===null)return J.Buffer.alloc(0);if(!(n instanceof X.default))return J.Buffer.alloc(0);let o=[],s=0;try{for await(let l of n){if(a.size>0&&s+l.length>a.size){let f=new V(`content size at ${a.url} over limit: ${a.size}`,"max-size");throw n.destroy(f),f}s+=l.length,o.push(l)}}catch(l){throw l instanceof be?l:new V(`Invalid response body while trying to fetch ${a.url}: ${l.message}`,"system",l)}if(n.readableEnded===!0||n._readableState.ended===!0)try{return o.every(l=>typeof l=="string")?J.Buffer.from(o.join("")):J.Buffer.concat(o,s)}catch(l){throw new V(`Could not create Buffer from response body for ${a.url}: ${l.message}`,"system",l)}else throw new V(`Premature close of server response while trying to fetch ${a.url}`)}var Ze=(a,n)=>{let o,s,{body:l}=a[Y];if(a.bodyUsed)throw new Error("cannot clone body after it is used");return l instanceof X.default&&typeof l.getBoundary!="function"&&(o=new X.PassThrough({highWaterMark:n}),s=new X.PassThrough({highWaterMark:n}),l.pipe(o),l.pipe(s),a[Y].stream=o,l=s),l},rs=(0,pe.deprecate)(a=>a.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),lr=(a,n)=>a===null?null:typeof a=="string"?"text/plain;charset=UTF-8":Kr(a)?"application/x-www-form-urlencoded;charset=UTF-8":yt(a)?a.type||null:J.Buffer.isBuffer(a)||pe.types.isAnyArrayBuffer(a)||ArrayBuffer.isView(a)?null:a instanceof qe?`multipart/form-data; boundary=${n[Y].boundary}`:a&&typeof a.getBoundary=="function"?`multipart/form-data;boundary=${rs(a)}`:a instanceof X.default?null:"text/plain;charset=UTF-8",Ho=a=>{let{body:n}=a[Y];return n===null?0:yt(n)?n.size:J.Buffer.isBuffer(n)?n.length:n&&typeof n.getLengthSync=="function"&&n.hasKnownLength&&n.hasKnownLength()?n.getLengthSync():null},Vo=async(a,{body:n})=>{n===null?a.end():await ts(n,a)};var rn=require("node:util"),St=Ee(require("node:http"),1),ur=typeof St.default.validateHeaderName=="function"?St.default.validateHeaderName:a=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(a)){let n=new TypeError(`Header name must be a valid HTTP token [${a}]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),n}},nn=typeof St.default.validateHeaderValue=="function"?St.default.validateHeaderValue:(a,n)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(n)){let o=new TypeError(`Invalid character in header content ["${a}"]`);throw Object.defineProperty(o,"code",{value:"ERR_INVALID_CHAR"}),o}},N=class extends URLSearchParams{constructor(n){let o=[];if(n instanceof N){let s=n.raw();for(let[l,f]of Object.entries(s))o.push(...f.map(m=>[l,m]))}else if(n!=null)if(typeof n=="object"&&!rn.types.isBoxedPrimitive(n)){let s=n[Symbol.iterator];if(s==null)o.push(...Object.entries(n));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");o=[...n].map(l=>{if(typeof l!="object"||rn.types.isBoxedPrimitive(l))throw new TypeError("Each header pair must be an iterable object");return[...l]}).map(l=>{if(l.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...l]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return o=o.length>0?o.map(([s,l])=>(ur(s),nn(s,String(l)),[String(s).toLowerCase(),String(l)])):void 0,super(o),new Proxy(this,{get(s,l,f){switch(l){case"append":case"set":return(m,_)=>(ur(m),nn(m,String(_)),URLSearchParams.prototype[l].call(s,String(m).toLowerCase(),String(_)));case"delete":case"has":case"getAll":return m=>(ur(m),URLSearchParams.prototype[l].call(s,String(m).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,l,f)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(n){let o=this.getAll(n);if(o.length===0)return null;let s=o.join(", ");return/^content-encoding$/i.test(n)&&(s=s.toLowerCase()),s}forEach(n,o=void 0){for(let s of this.keys())Reflect.apply(n,o,[this.get(s),s,this])}*values(){for(let n of this.keys())yield this.get(n)}*entries(){for(let n of this.keys())yield[n,this.get(n)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((n,o)=>(n[o]=this.getAll(o),n),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((n,o)=>{let s=this.getAll(o);return o==="host"?n[o]=s[0]:n[o]=s.length>1?s:s[0],n},{})}};Object.defineProperties(N.prototype,["get","entries","forEach","values"].reduce((a,n)=>(a[n]={enumerable:!0},a),{}));function Yo(a=[]){return new N(a.reduce((n,o,s,l)=>(s%2===0&&n.push(l.slice(s,s+2)),n),[]).filter(([n,o])=>{try{return ur(n),nn(n,String(o)),!0}catch{return!1}}))}var ns=new Set([301,302,303,307,308]),fr=a=>ns.has(a);var oe=Symbol("Response internals"),U=class extends le{constructor(n=null,o={}){super(n,o);let s=o.status!=null?o.status:200,l=new N(o.headers);if(n!==null&&!l.has("Content-Type")){let f=lr(n,this);f&&l.append("Content-Type",f)}this[oe]={type:"default",url:o.url,status:s,statusText:o.statusText||"",headers:l,counter:o.counter,highWaterMark:o.highWaterMark}}get type(){return this[oe].type}get url(){return this[oe].url||""}get status(){return this[oe].status}get ok(){return this[oe].status>=200&&this[oe].status<300}get redirected(){return this[oe].counter>0}get statusText(){return this[oe].statusText}get headers(){return this[oe].headers}get highWaterMark(){return this[oe].highWaterMark}clone(){return new U(Ze(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(n,o=302){if(!fr(o))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new U(null,{headers:{location:new URL(n).toString()},status:o})}static error(){let n=new U(null,{status:0,statusText:""});return n[oe].type="error",n}static json(n=void 0,o={}){let s=JSON.stringify(n);if(s===void 0)throw new TypeError("data is not JSON serializable");let l=new N(o&&o.headers);return l.has("content-type")||l.set("content-type","application/json"),new U(s,{...o,headers:l})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(U.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var ra=require("node:url"),na=require("node:util");var Qo=a=>{if(a.search)return a.search;let n=a.href.length-1,o=a.hash||(a.href[n]==="#"?"#":"");return a.href[n-o.length]==="?"?"?":""};var Jo=require("node:net");function Go(a,n=!1){return a==null||(a=new URL(a),/^(about|blob|data):$/.test(a.protocol))?"no-referrer":(a.username="",a.password="",a.hash="",n&&(a.pathname="",a.search=""),a)}var Zo=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Ko="strict-origin-when-cross-origin";function Xo(a){if(!Zo.has(a))throw new TypeError(`Invalid referrerPolicy: ${a}`);return a}function os(a){if(/^(http|ws)s:$/.test(a.protocol))return!0;let n=a.host.replace(/(^\[)|(]$)/g,""),o=(0,Jo.isIP)(n);return o===4&&/^127\./.test(n)||o===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(n)?!0:a.host==="localhost"||a.host.endsWith(".localhost")?!1:a.protocol==="file:"}function Ke(a){return/^about:(blank|srcdoc)$/.test(a)||a.protocol==="data:"||/^(blob|filesystem):$/.test(a.protocol)?!0:os(a)}function ea(a,{referrerURLCallback:n,referrerOriginCallback:o}={}){if(a.referrer==="no-referrer"||a.referrerPolicy==="")return null;let s=a.referrerPolicy;if(a.referrer==="about:client")return"no-referrer";let l=a.referrer,f=Go(l),m=Go(l,!0);f.toString().length>4096&&(f=m),n&&(f=n(f)),o&&(m=o(m));let _=new URL(a.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return m;case"unsafe-url":return f;case"strict-origin":return Ke(f)&&!Ke(_)?"no-referrer":m.toString();case"strict-origin-when-cross-origin":return f.origin===_.origin?f:Ke(f)&&!Ke(_)?"no-referrer":m;case"same-origin":return f.origin===_.origin?f:"no-referrer";case"origin-when-cross-origin":return f.origin===_.origin?f:m;case"no-referrer-when-downgrade":return Ke(f)&&!Ke(_)?"no-referrer":f;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function ta(a){let n=(a.get("referrer-policy")||"").split(/[,\s]+/),o="";for(let s of n)s&&Zo.has(s)&&(o=s);return o}var x=Symbol("Request internals"),wt=a=>typeof a=="object"&&typeof a[x]=="object",as=(0,na.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),ye=class extends le{constructor(n,o={}){let s;if(wt(n)?s=new URL(n.url):(s=new URL(n),n={}),s.username!==""||s.password!=="")throw new TypeError(`${s} is an url with embedded credentials.`);let l=o.method||n.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(l)&&(l=l.toUpperCase()),!wt(o)&&"data"in o&&as(),(o.body!=null||wt(n)&&n.body!==null)&&(l==="GET"||l==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let f=o.body?o.body:wt(n)&&n.body!==null?Ze(n):null;super(f,{size:o.size||n.size||0});let m=new N(o.headers||n.headers||{});if(f!==null&&!m.has("Content-Type")){let b=lr(f,this);b&&m.set("Content-Type",b)}let _=wt(n)?n.signal:null;if("signal"in o&&(_=o.signal),_!=null&&!Lo(_))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let y=o.referrer==null?n.referrer:o.referrer;if(y==="")y="no-referrer";else if(y){let b=new URL(y);y=/^about:(\/\/)?client$/.test(b)?"client":b}else y=void 0;this[x]={method:l,redirect:o.redirect||n.redirect||"follow",headers:m,parsedURL:s,signal:_,referrer:y},this.follow=o.follow===void 0?n.follow===void 0?20:n.follow:o.follow,this.compress=o.compress===void 0?n.compress===void 0?!0:n.compress:o.compress,this.counter=o.counter||n.counter||0,this.agent=o.agent||n.agent,this.highWaterMark=o.highWaterMark||n.highWaterMark||16384,this.insecureHTTPParser=o.insecureHTTPParser||n.insecureHTTPParser||!1,this.referrerPolicy=o.referrerPolicy||n.referrerPolicy||""}get method(){return this[x].method}get url(){return(0,ra.format)(this[x].parsedURL)}get headers(){return this[x].headers}get redirect(){return this[x].redirect}get signal(){return this[x].signal}get referrer(){if(this[x].referrer==="no-referrer")return"";if(this[x].referrer==="client")return"about:client";if(this[x].referrer)return this[x].referrer.toString()}get referrerPolicy(){return this[x].referrerPolicy}set referrerPolicy(n){this[x].referrerPolicy=Xo(n)}clone(){return new ye(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(ye.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var oa=a=>{let{parsedURL:n}=a[x],o=new N(a[x].headers);o.has("Accept")||o.set("Accept","*/*");let s=null;if(a.body===null&&/^(post|put)$/i.test(a.method)&&(s="0"),a.body!==null){let _=Ho(a);typeof _=="number"&&!Number.isNaN(_)&&(s=String(_))}s&&o.set("Content-Length",s),a.referrerPolicy===""&&(a.referrerPolicy=Ko),a.referrer&&a.referrer!=="no-referrer"?a[x].referrer=ea(a):a[x].referrer="no-referrer",a[x].referrer instanceof URL&&o.set("Referer",a.referrer),o.has("User-Agent")||o.set("User-Agent","node-fetch"),a.compress&&!o.has("Accept-Encoding")&&o.set("Accept-Encoding","gzip, deflate, br");let{agent:l}=a;typeof l=="function"&&(l=l(n)),!o.has("Connection")&&!l&&o.set("Connection","close");let f=Qo(n),m={path:n.pathname+f,method:a.method,headers:o[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:a.insecureHTTPParser,agent:l};return{parsedURL:n,options:m}};var dr=class extends be{constructor(n,o="aborted"){super(n,o)}};nr();Xr();var is=new Set(["data:","http:","https:"]);async function cr(a,n){return new Promise((o,s)=>{let l=new ye(a,n),{parsedURL:f,options:m}=oa(l);if(!is.has(f.protocol))throw new TypeError(`node-fetch cannot load ${a}. URL scheme "${f.protocol.replace(/:$/,"")}" is not supported.`);if(f.protocol==="data:"){let h=Ao(l.url),q=new U(h,{headers:{"Content-Type":h.typeFull}});o(q);return}let _=(f.protocol==="https:"?ia.default:aa.default).request,{signal:y}=l,b=null,E=()=>{let h=new dr("The operation was aborted.");s(h),l.body&&l.body instanceof Z.default.Readable&&l.body.destroy(h),!(!b||!b.body)&&b.body.emit("error",h)};if(y&&y.aborted){E();return}let R=()=>{E(),p()},S=_(f.toString(),m);y&&y.addEventListener("abort",R);let p=()=>{S.abort(),y&&y.removeEventListener("abort",R)};S.on("error",h=>{s(new V(`request to ${l.url} failed, reason: ${h.message}`,"system",h)),p()}),ss(S,h=>{b&&b.body&&b.body.destroy(h)}),process.version<"v14"&&S.on("socket",h=>{let q;h.prependListener("end",()=>{q=h._eventsCount}),h.prependListener("close",v=>{if(b&&q<h._eventsCount&&!v){let T=new Error("Premature close");T.code="ERR_STREAM_PREMATURE_CLOSE",b.body.emit("error",T)}})}),S.on("response",h=>{S.setTimeout(0);let q=Yo(h.rawHeaders);if(fr(h.statusCode)){let P=q.get("Location"),L=null;try{L=P===null?null:new URL(P,l.url)}catch{if(l.redirect!=="manual"){s(new V(`uri requested responds with an invalid redirect URL: ${P}`,"invalid-redirect")),p();return}}switch(l.redirect){case"error":s(new V(`uri requested responds with a redirect, redirect mode is set to error: ${l.url}`,"no-redirect")),p();return;case"manual":break;case"follow":{if(L===null)break;if(l.counter>=l.follow){s(new V(`maximum redirect reached at: ${l.url}`,"max-redirect")),p();return}let k={headers:new N(l.headers),follow:l.follow,counter:l.counter+1,agent:l.agent,compress:l.compress,method:l.method,body:Ze(l),signal:l.signal,size:l.size,referrer:l.referrer,referrerPolicy:l.referrerPolicy};if(!Io(l.url,L)||!zo(l.url,L))for(let Q of["authorization","www-authenticate","cookie","cookie2"])k.headers.delete(Q);if(h.statusCode!==303&&l.body&&n.body instanceof Z.default.Readable){s(new V("Cannot follow redirect with body being a readable stream","unsupported-redirect")),p();return}(h.statusCode===303||(h.statusCode===301||h.statusCode===302)&&l.method==="POST")&&(k.method="GET",k.body=void 0,k.headers.delete("content-length"));let ae=ta(q);ae&&(k.referrerPolicy=ae),o(cr(new ye(L,k))),p();return}default:return s(new TypeError(`Redirect option '${l.redirect}' is not a valid value of RequestRedirect`))}}y&&h.once("end",()=>{y.removeEventListener("abort",R)});let v=(0,Z.pipeline)(h,new Z.PassThrough,P=>{P&&s(P)});process.version<"v12.10"&&h.on("aborted",R);let T={url:l.url,status:h.statusCode,statusText:h.statusMessage,headers:q,size:l.size,counter:l.counter,highWaterMark:l.highWaterMark},I=q.get("Content-Encoding");if(!l.compress||l.method==="HEAD"||I===null||h.statusCode===204||h.statusCode===304){b=new U(v,T),o(b);return}let O={flush:Le.default.Z_SYNC_FLUSH,finishFlush:Le.default.Z_SYNC_FLUSH};if(I==="gzip"||I==="x-gzip"){v=(0,Z.pipeline)(v,Le.default.createGunzip(O),P=>{P&&s(P)}),b=new U(v,T),o(b);return}if(I==="deflate"||I==="x-deflate"){let P=(0,Z.pipeline)(h,new Z.PassThrough,L=>{L&&s(L)});P.once("data",L=>{(L[0]&15)===8?v=(0,Z.pipeline)(v,Le.default.createInflate(),k=>{k&&s(k)}):v=(0,Z.pipeline)(v,Le.default.createInflateRaw(),k=>{k&&s(k)}),b=new U(v,T),o(b)}),P.once("end",()=>{b||(b=new U(v,T),o(b))});return}if(I==="br"){v=(0,Z.pipeline)(v,Le.default.createBrotliDecompress(),P=>{P&&s(P)}),b=new U(v,T),o(b);return}b=new U(v,T),o(b)}),Vo(S,l).catch(s)})}function ss(a,n){let o=Rt.Buffer.from(`0\r
\r
`),s=!1,l=!1,f;a.on("response",m=>{let{headers:_}=m;s=_["transfer-encoding"]==="chunked"&&!_["content-length"]}),a.on("socket",m=>{let _=()=>{if(s&&!l){let b=new Error("Premature close");b.code="ERR_STREAM_PREMATURE_CLOSE",n(b)}},y=b=>{l=Rt.Buffer.compare(b.slice(-5),o)===0,!l&&f&&(l=Rt.Buffer.compare(f.slice(-3),o.slice(0,3))===0&&Rt.Buffer.compare(b.slice(-2),o.slice(3))===0),f=b};m.prependListener("close",_),m.on("data",y),a.on("close",()=>{m.removeListener("close",_),m.removeListener("data",y)})})}var hr,mr,ls=async a=>{hr={baseURL:"https://bard.google.com",headers:{Host:"bard.google.com","X-Same-Domain":"1","User-Agent":"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Origin:"https://bard.google.com",Referer:"https://bard.google.com/",Cookie:`__Secure-1PSID=${a};`}};let s=(await(await fetch("https://bard.google.com/",{method:"GET",headers:hr.headers,credentials:"include"})).text()).match(/SNlM0e":"(.*?)"/);if(s)mr=s[1];else throw new Error("Could not get Google Bard.");return mr},on=async(a,n={})=>{if(!mr)throw new Error("Make sure to call Bard.init(SESSION_ID) first.");let o={bl:"boq_assistant-bard-web-server_20230711.08_p0",_reqID:n._reqID?`${n._reqID}`:"0",rt:"c"},s=[[a],null,n?Object.values(n).slice(0,3):[null,null,null]],l={"f.req":JSON.stringify([null,JSON.stringify(s)]),at:mr},f=new URL("/_/BardChatUi/data/assistant.lamda.BardFrontendService/StreamGenerate",hr.baseURL);Object.keys(o).forEach(h=>f.searchParams.append(h,o[h]));let m=[];for(let h in l){let q=encodeURIComponent(h),v=encodeURIComponent(l[h]);m.push(q+"="+v)}m=m.join("&");let y=await(await fetch(f.toString(),{method:"POST",headers:hr.headers,body:m,credentials:"include"})).text(),b=JSON.parse(y.split(`
`)[3])[0][2];if(!b)throw new Error(`Google Bard encountered an error ${y}.`);let E=JSON.parse(b),R=JSON.parse(b)[4][0],S=R[1][0],p=R[4]?.map(h=>({tag:h[2],url:h[3][0][0],source:{original:h[0][0][0],website:h[1][0][0],name:h[1][1],favicon:h[1][3]}}));return{content:us(S,p),images:p,ids:{conversationID:E[1][0],responseID:E[1][1],choiceID:E[4][0][0],_reqID:parseInt(n._reqID??0)+1e5}}},us=(a,n)=>{if(!n)return a;for(let o of n){let s=`!${o.tag}(${o.url})`;a=a.replace(new RegExp("(?<!!)"+o.tag.replace("[","\\[").replace("]","\\]")),s)}return a},sn=async(a,n=!1)=>n?await on(a):(await on(a)).content,an=class{constructor(n){this.ids=n}async ask(n,o=!1){let s=await on(n,this.ids);return this.ids={...s.ids},o?s:s.content}export(){return this.ids}},sa={init:ls,askAI:sn,Chat:an};globalThis.fetch=cr;function ln(a,n,o="text",s,l){o==="text"&&(a+=` Return your response as a JSON with key 'response', and key 'explanation'. The value associated with 'response' should be a single string with your answer. The value associated with 'explanation' should be a string describing what you did. Be sure to be elaborate with your explanation, giving specific examples of what you did. If you did nothing, then simply say that. ONLY return that JSON and nothing else. Be accurate and concise. 

`),o==="code"&&(a+=` Return your response in a codeblock. DO NOT ADD ANY EXTRA CODE UNLESS TOLD TO. 

 Then add a JSON IN A SEPERATE CODEBLOCK at the end with ONE key, 'explanation'. The value associated with 'explanation' should be a string describing the code you have written, what you have changed, or WHY you wrote what you wrote. 

`);let f=(0,F.getPreferenceValues)(),[m,_]=(0,Ie.useState)(""),[y,b]=(0,Ie.useState)(!0),[E,R]=(0,Ie.useState)(""),[S,p]=(0,Ie.useState)(!1);async function h(){let v=new Date,T=await(0,F.showToast)(F.Toast.Style.Animated,n);async function I(){let O="";try{O=await(0,F.getSelectedText)(),a?l&&(O=`

`+O):a=O}catch{if(!a){T.title="Error",T.style=F.Toast.Style.Failure,b(!1),_("\u26A0\uFE0F No input was provided."),p(!0);return}if(!l){T.title="Error",T.style=F.Toast.Style.Failure,b(!1),_("\u26A0\uFE0F Raycast was unable to get the selected text."),p(!0);return}}try{return await sa.init(f["__Secure-1PSID"]),await sn(`${a}${O}`)}catch{T.title="Error",T.style=F.Toast.Style.Failure,b(!1),_("\u26A0\uFE0F Unable to reach Bard at this time."),p(!0);return}}I().then(O=>{if(!O)return;if(o==="text"){let L=O.match(/"response": "([^"]*)"/),k=O.match(/"explanation": "([^"]*)"/);L[1]?_(`## AI Response:
`+L[1].trim()+`


 ## Explanation: 
`+k[1].trim()):_(O),R(L[1].trim())}else if(o==="code"){let L=O.match(/(```[a-zA-Z]+?.*?```)/s),k=O.match(/```([a-zA-Z]+)?(.*?)```/s),ae=O.match(/"explanation": "([^"]*)"/);_(k?`## AI Code Response:
`+L[0].trim()+`


 ## Explanation: 
`+ae[1].trim():O),R(k[2].trim())}else _(O),R(O);b(!1),T.style=F.Toast.Style.Success;let P=(new Date().getTime()-v.getTime())/1e3;T.title=`Finished in ${P} seconds`})}async function q(){b(!0),_(""),h()}return(0,Ie.useEffect)(()=>{h()},[]),_jsx(F.Detail,{markdown:m,isLoading:y,actions:!y&&_jsx(F.ActionPanel,{title:"Actions"},_jsx(F.Action.CopyToClipboard,{title:"Copy Results",content:E}),_jsx(F.Action.Paste,{title:"Paste Results",content:E}),_jsx(F.Action,{title:"Retry",onAction:q,shortcut:{modifiers:["cmd"],key:"r"},icon:F.Icon.Repeat})),metadata:_jsx(F.Detail.Metadata,null,_jsx(F.Detail.Metadata.Label,{title:"Command Type",text:o.charAt(0).toUpperCase()+o.slice(1)}),_jsx(F.Detail.Metadata.Label,{title:"Command Title",text:s}),_jsx(F.Detail.Metadata.Separator,null),_jsx(F.Detail.Metadata.Label,{title:"Model",text:"PaLM 2"}),_jsx(F.Detail.Metadata.Label,{title:"Version",text:"2023.07.13"}))})}var fs="Making text friendly...";function la(){return ln(`Make the following text seem more friendly. Do not ask any rhetorical questions. That is, DO NOT use a question mark unless the user has a question mark in their input. Make it seem like you are talking to someone you know.

`,fs,"text","Make Friendly")}
/*! Bundled license information:

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)
*/
